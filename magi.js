!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):n.magi=t()}(this,function(){"use strict";var n={delay:0,duration:400,easing:"linear",transformOrigin:"50% 50% 0"},t=["translate","translate3d","translateX","translateY","translateZ","rotate","rotate3d","rotateX","rotateY","rotateZ","scale","scale3d","scaleX","scaleY","scaleZ","skew","skewX","skewY","matrix","matrix3d","perspective"];function e(n,t){return n.indexOf(t)>-1}var r={arr:function(n){return Array.isArray(n)},obj:function(n){return e(Object.prototype.toString.call(n),"Object")},str:function(n){return"string"==typeof n},fnc:function(n){return"function"==typeof n},und:function(n){return void 0===n},hex:function(n){return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(n)},rgb:function(n){return/^rgb/.test(n)},hsl:function(n){return/^hsl/.test(n)},col:function(n){return r.hex(n)||r.rgb(n)||r.hsl(n)}};function a(n){var t=/([+-]?[0-9#.]+)(%|px|pt|em|rem|in|cm|mm|ex|ch|pc|vw|vh|vmin|vmax|deg|rad|turn)?$/.exec(n);if(t)return t[2]}function i(n){var t={};for(var e in n)t[e]=n[e];return t}function o(n,t){var e=i(n);for(var r in n)e[r]=t.hasOwnProperty(r)?t[r]:n[r];return e}function u(n,t){return n.some(function(n){return n===t})}function s(n,i){return function(n,t){if(r.col(n))return n;var e=a(n),i=e?n.substr(0,n.length-e.length):n;return t&&!/\s/g.test(n)?i+t:i}(i,a(i)||(u(t,n)?function(n){return e(n,"translate")||"perspective"===n?"px":e(n,"rotate")||e(n,"skew")?"deg":void 0}(n):"px"))}var f=function(){function n(n,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,r.key,r)}}return function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}}();var c=function(){function e(){!function(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.animates=[]}return f(e,[{key:"init",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.tweenSettings=o(n,t),function(t){for(var e in t)if(!n.hasOwnProperty(e))return!0;return!1}(t)&&this.then(t),this}},{key:"format",value:function(n){var e=n.tweens,a=[],i=[];return n.props.forEach(function(n){var e=n.name,o=n.value;u(t,e)?i.push(e+"("+(r.arr(o)?o.join(", "):o)+")"):a.push({type:"style",args:[e,o]})}),a.push({type:"style",args:["transform",i.join(" ")]}),{animates:a,option:{transformOrigin:e.transformOrigin,transition:{delay:e.delay,duration:e.duration,timingFunction:e.easing}}}}},{key:"end",value:function(){var n=this;return{actions:[].concat(function(n){if(Array.isArray(n)){for(var t=0,e=Array(n.length);t<n.length;t++)e[t]=n[t];return e}return Array.from(n)}(this.animates)).map(function(t){return n.format(t)})}}},{key:"then",value:function(n){var t=o(this.tweenSettings,n),e=function(n,t){var e,a=[];for(var i in t)if("transform"===i)for(var o=[],u=/(\w+)\((.+?)\)/g;null!==(o=u.exec(t[i]));)a.push({name:o[1],value:o[2].split(/,\s*/)});else n.hasOwnProperty(i)||a.push({name:(e=i,e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()),value:t[i]});return a.map(function(n){return{name:n.name,value:r.arr(n.value)?n.value.map(function(t){return s(n.name,t)}):s(n.name,n.value)}})}(t,n);if(this.animates.length>0){var a=this.animates[this.animates.length-1].props,u=[],f=[];e.forEach(function(n){a.some(function(t){return t.name===n.name})||f.push(i(n))}),a.forEach(function(n){e.some(function(t){if(t.name===n.name)return u.push(i(t)),!0})||u.push(i(n))}),this.animates.push({props:u.concat(f),tweens:t})}else this.animates.push({props:e,tweens:t});return this}}]),e}();return function(n){return(new c).init(n)}});
